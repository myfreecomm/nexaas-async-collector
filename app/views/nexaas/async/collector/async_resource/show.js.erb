<% if @result.content_is_ready? %>
  <% if @result.is_file? %>
    window.nexaas_async_collector['<%= @unique_id %>'].collectUrl(
      '<%= nexaas_async_collector.async_resource_path(params[:id], format: @result.extension) %>'
    );
  <% else %>
    window.nexaas_async_collector['<%= @unique_id %>'].collectHTML(
      '<%= escape_javascript(@result.content.force_encoding('UTF-8').html_safe) %>'
    );
  <% end %>
<% end %>
